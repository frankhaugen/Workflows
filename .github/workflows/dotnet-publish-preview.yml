name: Publish Preview Workflow for nugets (Ubuntu)

on:
  workflow_call:
  workflow_dispatch:

jobs:
  build_pack_publish_preview:
    name: Publish Preview Job
    runs-on: ubuntu-latest
    steps:
      - name: Get version from latest release
        id: get_version
        uses: frankhaugen/Workflows/.github/actions/github-latest-release-version@main
      - name: Run .NET CI Action
        uses: frankhaugen/Workflows/.github/actions/dotnet-ci@main
        with:
          assemblyVersion: ${{ steps.get_version.outputs.version }}.${{ github.run_number }}
      - name: Publish preview NuGet
        uses: frankhaugen/Workflows/.github/actions/dotnet-nuget-cd@main
        with:
          dotnetVersion: 8.0.x
          configuration: Release
          nugetKey: ${{ secrets.NugetKey }}
          outputDirectory: nupkgs
          packageVersion: ${{ steps.get_version.outputs.version }}.${{ github.run_number }}-preview